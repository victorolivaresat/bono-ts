generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String         @id @default(cuid())
  email          String         @unique
  password       String
  name           String
  role           String         @default("user")
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  validatedBonos BonoAsignado[] @relation("ValidatedBy")
}

model TipoBono {
  id             String         @id @default(cuid())
  nombre         String         @unique
  descripcion    String?
  fechaInicio    DateTime
  fechaFin       DateTime
  activo         Boolean        @default(true)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  bonosAsignados BonoAsignado[]

  @@index([activo])
  @@index([nombre])
}

model BonoAsignado {
  id              String    @id @default(cuid())
  ticketNumber    String?
  tipoBonoId      String
  clientName      String
  documentNumber  String
  documentType    String
  phoneNumber     String
  status          String    @default("activo")
  observations    String?
  validatedBy     String?
  validatedAt     DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  tipoBono        TipoBono  @relation(fields: [tipoBonoId], references: [id], onDelete: Cascade)
  validatedByUser User?     @relation("ValidatedBy", fields: [validatedBy], references: [id])

  @@unique([documentType, documentNumber])
  @@index([ticketNumber])
  @@index([documentNumber])
  @@index([status])
  @@index([tipoBonoId])
}
